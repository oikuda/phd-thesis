\begin{figure}[ht]
\setlength{\instdist}{2.5cm}
\begin{centering}
\begin{msc}[c]{Protokol SSH za upravljanje prijenosom podataka}
\declinst{c}{}{SSH Klijent (C)}
\declinst{s}{}{SSH Poslužitelj (S)}

\mess{KEXINIT\textsubscript{C}}{c}{s}
\mscmark[br]{$L_C$}{s}
\nextlevel[2]

\mess{KEXINIT\textsubscript{S}}{s}{c}
\mscmark[bl]{$L_S$}{c}
\nextlevel[1.5]

\referencestart{p}{\\$L_{CS}$}{c}{s}
\nextlevel[2]
\referenceend{p}
\nextlevel[0.5]

\action*{generiranje $x, g^x$}{c}
\action*{generiranje $y, g^y$}{s}
\nextlevel[3]

\mess{KEXDH\_INIT}{c}{s}
\mscmark[br]{$g^x$}{s}
\nextlevel[1.5]

\action*{$K=g^{xy}$}{s}
\nextlevel[2]
\action*{$DP=S_S(C, S, KEXINIT_{(S,C)}, PK_S, K)$}{s}
\nextlevel[3.5]

\mess{KEXDH\_REPLY}{s}{c}
\mscmark[bl]{$PK_S,g^y$}{c}
\nextlevel[1.5]
\action*{$K=g^{xy}$}{c}
\nextlevel[2]

\mess{NEWKEYS\textsubscript{C}}{c}{s}
\nextlevel[2]

\mess{NEWKEYS\textsubscript{S}}{s}{c}
\nextlevel[1]

\referencestart{p}{\\$K_{CS}$}{c}{s}
\nextlevel[2]
\referenceend{p}

\end{msc}
\caption{Grafički prikaz razmjene poruka protokola za upravljanje prijenosom
    podataka protokola SSH}
\label{msc_ssh}
\end{centering}
\end{figure}
